{"ast":null,"code":"var _jsxFileName = \"/home/becky/Documents/Official Files/Blog/blogCli/src/components/Accounts/Login.js\";\nimport React from 'react';\nimport '../../assets/Styles/Styles.css';\nimport FormValidator from '../Validator/FormValidator';\nimport axios from 'axios';\nimport toastr from 'toastr';\nimport env from \"../../env\";\nimport bloglogo from '../../assets/Images/bloglogo.png';\nimport Navbar from \"../navbar/Navbar\";\nimport { MDBRow, MDBCol, MDBCard, MDBCardBody, MDBBtn, MDBContainer } from \"mdbreact\";\nexport default class Login extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleSubmit = async event => {\n      event.preventDefault();\n      const validation = this.validator.validate(this.state);\n      this.setState({\n        validation\n      });\n      this.submitted = true;\n\n      if (validation.isValid) {\n        try {\n          const res = await axios.post(\"\".concat(env.api, \"/users/login\"), this.state);\n          const token = res.data.data.token;\n          localStorage.setItem('token', token);\n          this.props.history.push('/create-post');\n          console.log(res);\n        } catch (err) {\n          toastr.options.positionClass = \"toast-top-center\";\n          toastr.error('Invalid Credentials, try again');\n        }\n      } else {\n        toastr.options.positionClass = \"toast-top-center\";\n        toastr.warning('Cannot Log In User Make sure all fields are correctly filled');\n      }\n    };\n\n    this.handleInputChange = this.handleInputChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.validator = new FormValidator([{\n      field: 'username',\n      method: 'isEmpty',\n      validWhen: false,\n      message: 'Username is required'\n    }, {\n      field: 'username',\n      method: 'matches',\n      args: [/^[a-z0-9A-Z\\s]*$/],\n      validWhen: true,\n      message: 'Username can only contain letters and numbers'\n    }, {\n      field: 'password',\n      method: 'isEmpty',\n      validWhen: false,\n      message: 'Password is required'\n    }]);\n    this.state = {\n      username: '',\n      password: '',\n      validation: this.validator.valid(),\n      successmessage: '',\n      errormessage: ''\n    };\n    this.submitted = false;\n  }\n\n  handleInputChange(event) {\n    event.preventDefault();\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  componentDidMount() {\n    const token = localStorage.getItem('token');\n    if (token) return this.props.history.push('/login');\n  }\n\n  render() {\n    let validation = this.submitted ? // if the form has been submitted at least once\n    this.validator.validate(this.state) : // then check validity every time we render\n    this.state.validation;\n    return React.createElement(MDBContainer, {\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(Navbar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["/home/becky/Documents/Official Files/Blog/blogCli/src/components/Accounts/Login.js"],"names":["React","FormValidator","axios","toastr","env","bloglogo","Navbar","MDBRow","MDBCol","MDBCard","MDBCardBody","MDBBtn","MDBContainer","Login","Component","constructor","props","handleSubmit","event","preventDefault","validation","validator","validate","state","setState","submitted","isValid","res","post","api","token","data","localStorage","setItem","history","push","console","log","err","options","positionClass","error","warning","handleInputChange","bind","field","method","validWhen","message","args","username","password","valid","successmessage","errormessage","target","name","value","componentDidMount","getItem","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../assets/Styles/Styles.css'\nimport FormValidator from '../Validator/FormValidator';\nimport axios from 'axios';\nimport toastr from 'toastr';\nimport env from \"../../env\";\nimport bloglogo from '../../assets/Images/bloglogo.png';\nimport Navbar from \"../navbar/Navbar\";\nimport { MDBRow, MDBCol, MDBCard, MDBCardBody, MDBBtn, MDBContainer } from \"mdbreact\";\n\n\n\n\n\nexport default class Login extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.handleInputChange = this.handleInputChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n\n\n        this.validator = new FormValidator([\n\n            {\n                field: 'username',\n                method: 'isEmpty',\n                validWhen: false,\n                message: 'Username is required'\n            },\n            {\n                field: 'username',\n                method: 'matches',\n                args: [/^[a-z0-9A-Z\\s]*$/],\n                validWhen: true,\n                message: 'Username can only contain letters and numbers'\n            },\n            {\n                field: 'password',\n                method: 'isEmpty',\n                validWhen: false,\n                message: 'Password is required'\n            }\n        ])\n\n        this.state = {\n            username: '',\n            password: '',\n            validation: this.validator.valid(),\n            successmessage: '',\n            errormessage: '',\n\n        };\n        this.submitted = false;\n    }\n\n    handleInputChange(event) {\n        event.preventDefault()\n        this.setState({ [event.target.name]: event.target.value });\n    }\n\n    handleSubmit = async (event) => {\n        event.preventDefault();\n\n        const validation = this.validator.validate(this.state);\n        this.setState({ validation });\n        this.submitted = true;\n\n        if (validation.isValid) {\n            try {\n                const res = await axios.post(`${env.api}/users/login`, this.state);\n                const token = res.data.data.token;\n\n                localStorage.setItem('token', token);\n\n                this.props.history.push('/create-post');\n                console.log(res);\n            } catch (err) {\n                toastr.options.positionClass = \"toast-top-center\";\n                toastr.error('Invalid Credentials, try again');\n            }\n        }\n        else {\n            toastr.options.positionClass = \"toast-top-center\";\n\n            toastr.warning('Cannot Log In User Make sure all fields are correctly filled');\n        }\n\n    }\n\n    componentDidMount() {\n        const token = localStorage.getItem('token');\n\n        if (token) return this.props.history.push('/login');\n    }\n\n\n\n    render() {\n        let validation = this.submitted ?        // if the form has been submitted at least once\n            this.validator.validate(this.state) :   // then check validity every time we render\n            this.state.validation;\n        return (\n             <MDBContainer fluid >\n <Navbar/>\n             </MDBContainer>\n            \n        );\n    }\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}